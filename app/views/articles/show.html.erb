<% provide(:title, "#{@article.title}") %>

<div class="article-container mt-4">
  <div class="row">
    <div class="col-lg-9">

      <h2><%= @article.title %></h2>

      <div>
        <span class="article-category badge badge-warning">
          カテゴリ：<%= (@article.category.nil?) ? "なし" : @article.category.name %>
        </span>
        <% @article.tags.pluck(:name).each do |tag_name| %>
          <span class="badge badge-info"><%= link_to tag_name, tag_path(tag_name), class: "article-tag" %></span>
        <% end %>
        </span>
      </div>

      <p class="mt-3">出典：<%= @article.citation %></p>

      <p class="article-posted-time mt-3"><%= @article.created_at.strftime("%Y年%m月%d日 %H:%M")%></p>
      
      <div class="clearfix">
        <div class="float-right pl-sm-3 pb-sm-2">
          <% if @article.thumbnail.url %>
            <%= image_tag @article.thumbnail.url, class: "article-show-image", size: "300x300"  %>
          <% elsif @article.category %>
            <%= image_tag "https://d1y0f4wly1zzzj.cloudfront.net/thumbnail/category_#{@article.category.name}.jpg", class: "article-show-image", size: "300x300" %>
          <% else %>
            <%= image_tag "https://d1y0f4wly1zzzj.cloudfront.net/thumbnail/default_thumbnail.png", class: "article-show-image", size: "300x300" %>
          <% end %>
        </div>
        <%= @article.content %>
      </div>

      <div class="comment">
        <%= render 'comments/comment_area', comments: @comments %>
        <% if logged_in? %>
          <div class="comment-form">
            <%= form_with(model: [@article, @comment], remote: true) do |f| %>
              <%= f.text_area :content, class: "form-control my-3", placeholder: "コメントを入力" , rows: "4", id: "comment-textarea" %>
              <%= f.submit "コメントする", class: "btn btn-primary" %>
            <% end %>
          </div>
        <% end %>
      </div>
        

    </div>

    <div class="col-lg-3 article-sidebar">
      <h5>関連した記事</h5>
        <% @related_articles.each do |article| %>
          <div class="related-article-wrapper">
            <% if @article.thumbnail.url %>
              <%= image_tag @article.thumbnail.url, class: "article-show-image", size: "200x200"  %>
            <% elsif @article.category %>
              <%= image_tag "https://d1y0f4wly1zzzj.cloudfront.net/thumbnail/category_#{@article.category.name}.jpg", class: "article-show-image", size: "200x200" %>
            <% else %>
              <%= image_tag "https://d1y0f4wly1zzzj.cloudfront.net/thumbnail/default_thumbnail.png", class: "article-show-image", size: "200x200" %>
            <% end %>
            <p><%=link_to article.title, article_path(article), class: "h6 d-block"  %></p>
          </div>
        <% end %>
    </div>
  </div>
</div> 